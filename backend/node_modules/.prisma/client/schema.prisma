// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// 1. Defines the Prisma Client generator
generator client {
  provider = "prisma-client-js"
}

// 2. Defines the database connection
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL") // This tells Prisma to use the URL from your .env file
}

// --- Your Application Models ---

enum AssetType {
  CODE
  PATENT
  LYRICS
  RESEARCH
}

model Product {
  id             String    @id @default(uuid())
  title          String
  description    String?
  price          Float
  assetType      AssetType
  assetUrl       String
  cerebrasScore  Json?
  executionProof String?
  llamaSummary   Json?
  status         String    @default("processing")
  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @updatedAt

  orders Order[]
}

model Order {
  id        String  @id @default(uuid())
  productId String
  product   Product @relation(fields: [productId], references: [id])

  stripePaymentIntentId String @unique
  licenseKey            String @unique
  status                String @default("completed")

  createdAt DateTime @default(now())
}
